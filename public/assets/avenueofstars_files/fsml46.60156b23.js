(this.$WP=this.$WP||[]).push(["fsml46",(e,t)=>{"use strict";var n,a,i,r,o,s,l,u,c,d="interaction_mutation_buffer",m=(e,t)=>e({request:{clientRequestTimestampMs:Date.now(),request:t}}),v=!1,g=e=>{var t=(()=>{try{return JSON.parse(localStorage.getItem(d)||"[]")}catch(e){}return[]})();t.length>0&&!v?(v=!0,m(e,t).then((()=>{(e=>{try{var t=JSON.parse(localStorage.getItem(d)||"[]");localStorage.setItem(d,JSON.stringify(t.filter((t=>e.every((e=>!a(t,e)))))))}catch(e){}})(t)})).finally((()=>{v=!1}))):t.length>0&&v&&setTimeout((()=>g(e)),3e3)},k=(e,t,n,a)=>{var i=Object.assign({pageUid:t,eventTimestampMs:Date.now()},e),r=[];return n&&r.push({key:"user_id",value:n}),a&&r.push({key:"session_id",value:a}),0!==r.length&&(i=Object.assign({opaqueIds:r},i)),i},p=()=>{var[,e]=s(l),[,{uid:t}]=n.useContext(i),{userId:a,sessionId:o}=n.useContext(r);return n.useCallback((n=>{((e,t,n,a)=>{(e=>{try{var t=JSON.parse(localStorage.getItem(d)||"[]");t.push(e),localStorage.setItem(d,JSON.stringify(t))}catch(e){}})(k(e,t,n,a))})(n,t,a,o),setTimeout((()=>g(e)),3e3)}),[e,o,t,a])},I=()=>{var[,e]=s(l),[,{uid:t}]=n.useContext(i),{userId:a,sessionId:o}=n.useContext(r);return n.useCallback((n=>{var i=k(n,t,a,o);return new Promise(((t,n)=>{m(e,[i]).then((e=>{var a,i,r;return!e.error&&(null==(a=e.data)||null==(i=a.Impressions_postInteractionsV2)||null==(r=i.response)?void 0:r[0])?t():n()}),(()=>n()))}))}),[e,o,t,a])},f=()=>{var[,e]=s(l);n.useEffect((()=>{requestIdleCallback((()=>{g(e)}))}),[e])},S="interactionV3_mutation_buffer",h=!1,N=e=>{var t=(()=>{try{return JSON.parse(localStorage.getItem(S)||"[]")}catch(e){}return[]})();t.length>0&&!h?(h=!0,e({request:{clientRequestTimestampMs:Date.now(),request:t}}).then((()=>{(e=>{try{var t=JSON.parse(localStorage.getItem(S)||"[]");localStorage.setItem(S,JSON.stringify(t.filter((t=>e.every((e=>!a(t,e)))))))}catch(e){}})(t)})).finally((()=>{h=!1}))):t.length>0&&h&&setTimeout((()=>N(e)),3e3)},y=()=>{var[,e]=s(u),[,{uid:t}]=n.useContext(i),{userId:a,sessionId:l}=n.useContext(r),{userAgentCategory:c}=n.useContext(o);return n.useCallback((n=>{(e=>{try{var t=JSON.parse(localStorage.getItem(S)||"[]");t.push(e),localStorage.setItem(S,JSON.stringify(t))}catch(e){}})(Object.assign({pageUid:t,userId:a,sessionId:l,userAgent:c,eventTimestampMs:Date.now()},n)),setTimeout((()=>N(e)),3e3)}),[e,t,a,l,c])},b=()=>{var[,e]=s(u);n.useEffect((()=>{requestIdleCallback((()=>{N(e)}))}),[e])},O="interaction_buffer",q=e=>{if(0===e.length)return Promise.resolve();var t=new URLSearchParams("?batched=true");return e.forEach(((e,n)=>{e.forEach(((e,a)=>{void 0!==e&&t.append(`data[${n}][${a}]`,e)}))})),fetch("/GARecord",{method:"POST",body:t.toString(),credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"}}).catch((e=>{console.error(e)}))},C=e=>{var t=new URLSearchParams;return Object.entries(e).forEach((([e,n])=>{"eventId"!==e&&t.append(e,n)})),t},V=!1,_=()=>{if(V)w();else{V=!0;try{var e=localStorage.getItem(O),t=e?JSON.parse(e):[];q(t.map(C)).then((()=>{var e=localStorage.getItem(O),n=e?JSON.parse(e):[];localStorage.setItem(O,JSON.stringify(n.filter((e=>t.every((t=>!a(t,e)))))))})).finally((()=>{V=!1}))}catch(e){V=!1}}},T=null,w=()=>{null!==T&&clearTimeout(T),T=setTimeout(_,1e3)},D=e=>{try{var t=localStorage.getItem(O),n=t?JSON.parse(t):[];n.push(e),localStorage.setItem(O,JSON.stringify(n))}catch(e){return!1}return w(),!0},J=e=>{var t={eventId:Math.random().toString()};e.forEach(((e,n)=>{t[n]=e})),D(t)||q([e])},x=e=>{try{var t;return(null==(t=e.match(/^\/([a-zA-Z0-9_]+)/))?void 0:t[1])||"Home"}catch(e){return"Unknown"}},R=()=>{var[{page:e,params:t},{uid:a}]=n.useContext(i),{userId:o}=n.useContext(r),s=(null==t?void 0:t.detailId)||void 0,l=(null==t?void 0:t.geoId)||void 0;return n.useCallback((t=>{var n,i="Unknown"===e?(e=>{try{var t,n;return(null==(t=e.match(/-d([0-9]+)/))?void 0:t[1])||(null==(n=e.match(/-g([0-9]+)/))?void 0:n[1])||void 0}catch(e){return}})(window.location.pathname):s||l||void 0,r={gac:t.module,gaa:t.action,gal:t.context,gav:t.value,gani:t.nonInteraction,gasl:null!=(n=t.location)?n:i,gass:"Unknown"===e?x(window.location.pathname):e,gapu:a,gams:null!==o,eventId:Math.random().toString()};D(r)||q([C(r)])}),[e,s,l,a,o])},L=e=>{var t=R(),{module:a,action:i,context:r,value:o,location:s,nonInteraction:l}=e||{};return n.useCallback((()=>{a&&i&&t({module:a,action:i,context:r,value:o,location:s,nonInteraction:l})}),[t,a,i,r,o,s,l])};return[()=>{(l=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"LogInteractions"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"request"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Impressions_InteractionsRequestInput"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"Impressions_postInteractionsV2"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"request"},"value":{"kind":"Variable","name":{"kind":"Name","value":"request"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"response"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":157}}')).__key=0xe635e385a1b2,(u=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"LogInteractionsV3"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"request"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Impressions_UserInteractionsRequestInput"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"Impressions_postInteractionsV3"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"request"},"value":{"kind":"Variable","name":{"kind":"Name","value":"request"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"response"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":163}}')).__key=0xa49a813b509f,(c=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"LogInteractionV4"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"interaction"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"InteractionV4Input"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"logInteractionV4"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"interaction"},"value":{"kind":"Variable","name":{"kind":"Name","value":"interaction"}}}],"directives":[]}]}}],"loc":{"start":0,"end":119}}')).__key=0x790de86432c2,"undefined"!=typeof requestIdleCallback&&requestIdleCallback(w),e({LogInteractionV4:c,enqueue:J,useBlockingInteractionLogger:I,useGARecordCallback:L,useGARecorder:R,useInteractionLogger:p,useInteractionV3Logger:y,useSubmitInteractionBufferEffect:f,useSubmitInteractionV3BufferEffect:b})},[e=>n=e,e=>a=e.default,e=>(i=e.Route,r=e.Visitor,o=e.Device),e=>s=e.useMutation]]},["cDcdfi","YwNsO_","2R4xv2","5X2em-"]]);
