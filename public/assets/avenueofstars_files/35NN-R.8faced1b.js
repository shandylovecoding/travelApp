(this.$WP=this.$WP||[]).push(["_azji4/35NN-R",(e,l)=>{"use strict";var t,a,n,r,i,o,s,u,d,c,m,E,C,b,I,f,v,L,A,y,R,p,g,_,M,S,h,T,O,w,k,N,P,D,V="_3p7pfjak",G=20,U=e=>{var l,D,U,W,x,Y,F,H,B,{albumId:q,referenceMediaId:K,categoryId:Q,typeId:z,mediaId:j,locationId:$,locationName:J,secondaryTitleContent:X,actionHandler:Z,offer:ee,adSlot:le,businessContact:te,skipQuickAlbums:ae,disableControls:ne,getShareUrlForMedia:re,galleryRendererOverride:ie,fullscreenRendererOverride:oe,sort:se,quickAlbumsConfiguration:ue,queryClientOverride:de,heroDataStrategyOverride:ce,pageDataStrategyOverride:me,trackingCallback:Ee}=e,{localize:Ce}=M(),be=C(),Ie=de||"mv",fe=ce||"mvh",ve=me||("RECENCY"===se?"mr":"m"),Le=ue||"mvqa",Ae=s(q),ye=A(Ie,fe,$),Re=A(Ie,Le,$),pe=t.useCallback((e=>{var l,t="",a=null==e||null==(l=e.mediaAlbum)?void 0:l.album;if(a)if(200!==e.mediaAlbum.status)t=R;else if(0===a.totalMediaCount)t=y;else{var n;t=(null==(n=a.mediaList)?void 0:n[0])?g:p}else t=y;ye(t)}),[ye]),ge=t.useCallback((e=>{var l=null==e?void 0:e.mediaWindow;if(l){var t="";if(200!==(null==l?void 0:l.status))t=R;else{var a,n,r,i,o=null==l||null==(a=l.windowPanes)||null==(n=a[0])||null==(r=n.albums)?void 0:r[0];t=o&&0!==o.totalMediaCount?(null==o||null==(i=o.mediaList)?void 0:i[0])?g:p:y}Re(t)}}),[Re]),_e={locationId:$,albumId:q===u.PANO_ALBUM?u.ALL_ALBUMS:q,client:Ie,dataStrategy:fe,filter:d(z),subAlbumId:q===u.PANO_ALBUM?u.PANO_ALBUM:Q,referenceMediaId:K,photos360Enabled:h()},[Me]=a({query:n,variables:_e}),{fetching:Se,data:he,error:Te}=Me,Oe=null==he||null==(l=he.mediaAlbum)?void 0:l.status,we=Se?null:null==he||null==(D=he.mediaAlbum)?void 0:D.album;if(Te){var ke=Te.message.replace(/Error #[0-9]+/g,"Error #xxx");console.error("[MASDesktopMediaViewer] albumQuery",ke),we||Z({type:"ERROR",albumId:q,statusCode:-1,errorMessage:Te.message})}Oe&&Oe>=400&&K&&(console.error(`[MASDesktopMediaViewer] albumQuery received status ${Oe}`),Z({type:"ERROR",albumId:q,statusCode:Oe})),t.useEffect((()=>{Se||pe(he)}),[he,Se,pe]);var Ne=null==we||null==(U=we.mediaList)?void 0:U[0],Pe=(null==we?void 0:we.offset)||0,De=t.useMemo((()=>({locationId:$,albumId:q===u.PANO_ALBUM?u.ALL_ALBUMS:q,subAlbumId:q===u.PANO_ALBUM?u.PANO_ALBUM:Q,client:Ie,dataStrategy:ve,filter:d(z),offset:0,limit:G,photos360Enabled:h()})),[$,q,Q,Ie,ve,z]),[Ve,Ge]=r({query:i,variables:De}),Ue=Object.keys(Ve).length,We=t.useCallback((e=>{var l=Math.abs(Math.floor(e/G));return(null==Ve?void 0:Ve[l])?null==Ve?void 0:Ve[String(l)]:(Ge({offset:l*G,limit:G}),Z({type:"PAGED",pageNumber:l}),{fetching:!0,data:null})}),[Ge,Ve,Z]),{fetching:xe}=Ve[0];t.useEffect((()=>{xe||be(b.GALLERY_VIEW_PHOTOS_SEEN,{photosSeen:Ue*G})}),[xe,Ue,be]);var Ye=t.useCallback((e=>{var l,t,a;if(e===Pe&&se!==c.RECENCY)return Ne;var n=e,r=We(n);return(null==r?void 0:r.fetching)?null:null==r||null==(l=r.data)||null==(t=l.mediaAlbumPage)||null==(a=t.mediaList)?void 0:a[n%G]}),[We,Ne,Pe,se]),Fe=t.useCallback((e=>{var l=Ye(e);return l?{media:l,loading:!1}:{loading:!0}}),[Ye]),He=t.useRef(Object.assign({},E)),[Be,qe]=t.useState(!1),Ke=e=>{qe(e)},Qe=t.useCallback(((e,l)=>{var a=Ye(e);oe&&oe(a);var n=(null==we?void 0:we.totalMediaCount)||0;return a?t.createElement(f,{media:a,shareUrl:re?re(a):null,totalMediaInfo:{selectedIndex:e,totalCount:n},onSwipeRight:()=>{},onSwipeLeft:()=>{},innateTranslations:!1,businessContact:te,onFullscreenMedia:Ke,locationId:$,isActiveViewer:l,trackingCallback:Ee}):null}),[Ye,oe,re,we,te,$,Ee]),ze="grid",je=t.useRef(!1),$e={locationId:$,client:Ie,filter:m(),configuration:Le,photos360Enabled:h()},[Je]=a({query:o,variables:$e,pause:!!ae}),{data:Xe,fetching:Ze,error:el}=Je;el&&Z({type:"ERROR",albumId:q,statusCode:-1,errorMessage:el.message}),Ze||ge(Xe);var ll=null==Xe||null==(W=Xe.mediaWindow)||null==(x=W.windowPanes)||null==(Y=x[0])?void 0:Y.albums,tl=ll&&ll.map((e=>{var l,a;return{id:e.albumId,titleNode:t.createElement(_,{count:e.totalMediaCount,title:e.name}),thumbnailNode:t.createElement(I,{width:"100%",height:"100%",sources:(null==(l=e.mediaList)||null==(a=l[0])?void 0:a.photoSizes)||[]})}})),al=null==Xe||null==(F=Xe.mediaWindow)||null==(H=F.windowPanes)||null==(B=H[0])?void 0:B.albums,nl={locationId:$,albumId:q,client:Ie,filter:m(),configuration:Ae,photos360Enabled:h()},[rl]=a({query:o,variables:nl,pause:!!ne}),{data:il,error:ol}=rl;ol&&Z({type:"ERROR",albumId:q,statusCode:-1,errorMessage:ol.message});var sl=t.useCallback((e=>{Z({type:"SOURCE_CHANGE",typeId:e}),be(b.GALLERY_VIEW_TYPE_CLICK,{typeId:e}),be(b.SOURCE_FILTER_CLICK,{typeId:e})}),[Z,be]),ul=t.useCallback((e=>{Z({type:"CATEGORY_CHANGE",categoryId:e}),be(b.GALLERY_VIEW_CATEGORY_CLICK,{categoryId:e}),be(b.ADVANCED_FILTER_CLICK,{categoryId:e})}),[Z,be]),[dl,cl]=t.useState(96),ml=e=>{cl(e)},[El,Cl]=t.useState(!1),bl=e=>{Cl(e)},Il=t.useCallback((e=>{Z({type:"SORT",sort:e}),be(b.SORT_TYPE_CHANGE,{sort:e})}),[Z,be]),fl=t.useCallback((()=>{var e,l;if(il&&(null==(e=il.mediaWindow)||null==(l=e.windowPanes[0])?void 0:l.albums)){var a,{albums:n}=il.mediaWindow.windowPanes[0];if(q===u.TRAVELER_ALBUM){var r=al&&al.find((e=>e.albumId===u.TRAVELER_ALBUM));a={mediaCounts:{TRAVELER:(null==r?void 0:r.totalMediaCount)||0}}}else a=n.find((e=>e.albumId===Q));var i,o,s,d=a?a.mediaCounts:null;if(d)return t.createElement("div",{className:"_15-ye93f"},t.createElement("div",{className:V},t.createElement(T,{key:"MVControlsContainer",onHeightChange:ml,filterExpand:El},t.createElement("div",{className:"shDFoA-4"},t.createElement("div",{className:"_3QDICRpn"},t.createElement("div",{className:"_2Lab6O72"},t.createElement(O,{selectedSourceId:z,sourceCounts:d,onSelect:sl}),t.createElement(w,{albums:null==il||null==(i=il.mediaWindow)||null==(o=i.windowPanes)||null==(s=o[0])?void 0:s.albums,selectedTypeId:z,onSelect:ul,selectedFilterId:Q,selectedAlbumId:q,onExpandChange:bl}))),t.createElement("div",null,t.createElement(k,{selectedSort:null!=se?se:c.ML,onSelect:Il}))))))}return t.createElement("div",{className:V,key:"MVControlsContainer"},t.createElement(T,{header:"",loading:!0,onHeightChange:ml,filterExpand:El},t.createElement(N,{height:"100%"})))}),[il,Q,z,q,ul,sl,al,El,se,Il]),vl=t.useRef(!K);!vl.current&&He.current.setSelectedIndex&&we&&(we.offset||0===we.offset)&&(He.current.setSelectedIndex(we.offset),vl.current=!0);var Ll=t.useCallback((e=>{switch(e.type){case v.albumSelect:Z({type:"ALBUM",referenceCompoundMediaId:null,albumId:e.albumId}),be(b.GALLERY_VIEW_ALBUM_CLICK,{albumId:e.albumId});break;case v.galleryItemClicked:be(b.DETAIL_VIEW_GALLERY_CLICK,{tileDetails:{offset:e.offset,mode:e.mode},isMWRedesign:!0}),be(b.GRID_VIEW_ITEM_CLICK),qe(!1),Z({type:"GALLERY_CLICK",selectedIndex:e.selectedIndex,offset:e.offset,mode:e.mode,newMedia:Fe(e.selectedIndex)});break;case v.fullscreenNav:Z({type:"FULLSCREEN_NAV",newMedia:Fe(e.newIndex),newIndex:e.newIndex});break;case v.fullscreenClose:be(b.DETAIL_VIEW_DISMISS,{mvDetailViewCloseType:"controls"===e.closeType?"album_change":e.closeType}),be(b.VIEW_GALLERY_BUTTON_CLICK),Z({type:"FULLSCREEN_CLOSE",closeType:e.closeType});break;case v.scroll:!je.current&&e.position>0&&(be(b.GALLERY_VIEW_SCROLL_ENGAGEMENT),je.current=!0),Z({type:"SCROLL",position:e.position});break;case v.close:Z({type:"CLOSE"})}}),[Z,Fe,ze,be]);return t.useEffect((()=>{He.current.backToTop(),He.current.closeDetail(),be(b.GALLERY_VIEW,{isMWRedesign:!0}),je.current=!1}),[q,z,Q,be]),t.useEffect((()=>{j||He.current.closeDetail()}),[j]),t.createElement(S,{close:()=>Z({type:"CLOSE"}),galleryRenderer:(e,l,a)=>{var n=Ye(e);return ie?ie(n,l,a):n?t.createElement(P,{media:n,width:l,height:a,locationId:$}):null},fullRenderer:Qe,galleryOffsetTop:ne?0:dl-2,controlsRenderer:ne?null:fl,totalCount:(null==we?void 0:we.totalMediaCount)||0,quickAlbumsDefinition:tl,selectedAlbumId:q,actionHandler:Ll,onTileGalleryControls:e=>{He.current=e},disableFullscreenNavigation:Be,disableFullscreenClose:Be,titleText:J&&Ce.string("PhotocC_ffffe1a6",{1:J}),secondaryTitleContent:X,secondaryHeaderContent:ee,auxiliaryComponent:le?le():null,layoutStyle:ze,detailCloseButton:t.createElement((()=>t.createElement(L,{layout:ze})),null),useHero:!1,noHistoryManipulation:!0})};return[()=>{D=t.memo(U),e("default",D)},[e=>t=e,e=>a=e.useQuery,e=>(n=e.albumQuery,r=e.usePaginatedQuery,i=e.albumPageQuery,o=e.quickAlbumsQuery),e=>(s=e.getRHRFiltersWindowConfig,u=e.AlbumTypes,d=e.getFilter,c=e.mediaSortType,m=e.getMediaFilterToRetrieveAllPhotos),e=>E=e.DEFAULT_CONTROLS,e=>(C=e.useMVTracking,b=e.trackedPageActions),e=>I=e.ResponsiveImage,e=>f=e.MWDetailViewer,e=>v=e.mvActions,e=>L=e.GalleryButton,e=>(A=e.useMediaTracking,y=e.NO_PHOTO,R=e.ERROR_MSG,p=e.PRIMARY_MISSING,g=e.PRIMARY_OK),e=>_=e.StockTitle,e=>M=e.useLocalize,e=>S=e.DesktopViewer,e=>h=e.photos360Enabled,e=>T=e.ControlsContainer,e=>(O=e.SourceFilterDropdown,w=e.AlbumPills,k=e.SortDropdown),e=>N=e.default,e=>P=e.default]]},["cDcdfi","5X2em-","n4rOEs","wc54S1","vYoxP4","yOERmA","KwOV1Z","pCKTMp","1yAwqb","egvnuD","zdk9wF","UuUmq4","0DsHEV","EwqHnS","h179JP","xTNd-J","5lGCzf","Xi-2HZ","MTPLEG"]]);
