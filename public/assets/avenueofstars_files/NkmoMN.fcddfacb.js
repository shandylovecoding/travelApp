(this.$WP=this.$WP||[]).push(["NkmoMN",(e,t)=>{"use strict";var n,i,a,s,r,l,o,u,c,d,m,p,v,g,S,k,f,C,_,I,b,h,M,P,y,E,w,N,R="interstitialPageViews",U="interstitialDelayPageViews",x="sessionPreviouslySeenInterstitial",O="sessionPreviouslySeenInterstitialGhost",D="previouslyIntervalSeenInterstitial",T="previouslyTotalSeenInterstitial",V="previouslyIntervalSeenInterstitialGhost",A="previouslyTotalSeenInterstitialGhost",F=()=>m.get(R)||0,H=()=>m.get(U)||0,L=()=>m.get(D)||!1,G=()=>m.get(T)||0,q=()=>p.get(x)||0,$=()=>m.get(V)||!1,B=()=>m.get(A)||0,K=()=>p.get(O)||0,Q=({children:e,onShow:t,delaySeconds:i,delayPageViews:a,afterPageViews:s,maxSeen:r,maxSeenSession:l,variantName:u,isDatePickerOpen:c,suppress:d,ignoreInterval:g,onSkip:S,fallback:k=null,isControl:f=!1})=>{var C=n.useMemo(F,[]),_=n.useMemo(H,[]),b=n.useMemo(L,[]),h=n.useMemo(G,[]),M=n.useMemo(q,[]),P=n.useMemo($,[]),y=n.useMemo(B,[]),E=n.useMemo(K,[]),[w,N]=n.useState(!1),[,{uid:Q}]=n.useContext(o),X=v();n.useEffect((()=>{!g&&b||m.set(R,C+1)}),[C,b,g]),n.useEffect((()=>{(d||c)&&N(!1)}),[d,c]);var J=n.useMemo((()=>!c&&C>=s&&(g||!b)&&h<r&&M<l),[c,C,s,b,h,M,r,l,g]);return n.useEffect((()=>{!J&&S&&S()}),[J,S]),n.useEffect((()=>{var e=_<a;if(J){e&&m.set(U,_+1);var n=setTimeout((()=>{document.querySelector('[title="regcontroller"]')||document.getElementById("explicitPreferences")||((g||!P)&&E<l&&h<r&&J&&!c&&(X({optimusMarketingInterstitial:{name:f?`control_${u}`:u,pageviewUid:Q}}),f&&(p.set(O,E+1),m.set(V,!0,I),m.set(A,y+1))),d||!J||c||(p.set(x,M+1),m.set(D,!0,I),m.set(T,h+1),N(!0),t&&t()))}),e?1e3*i:0);return()=>clearTimeout(n)}return()=>{}}),[J,N,i,a,_,M,E,h,y,P,r,l,c,t,d,X,Q,u,f,g]),w?e:k},X="plusMarketingInterstitial",J="SUMMER25",W="SUMMER50",j="SUMMER75",Z="SUMMER0",z="plus_discount_campaign_1623875391",Y="plus_discount_campaign_phase_2_1625667802",ee="control",te="test_bubble",ne="test_cactus",ie="low_discount",ae="medium_discount",se="high_discount",re=["Attractions","AttractionsFusion","AttractionsHome","AttractionProductReview","Attraction_Review","CheapFlightsHome","Cruises","Flights","Hotels","HotelsHome","HotelsList","HotelsNear","Hotel_Review","LocationPhotoDirectLink","RentalCars","RentalCarsGeo","Rentals","Restaurants","ShowForum","ShowTopic","ShowUserReviews","SmartDeals","Tourism","VacationRentals"],le="edu_endless",oe="optimus_brand_interstitial",ue=(e,t)=>{var{userId:n}=i(u),{fetching:a,totalUgc:s}=(e=>{var t,n,i,[{fetching:a,data:s,error:r}]=_({query:b,variables:{userId:{id:e}},pause:!e});return{fetching:a,totalUgc:(null==s||null==(t=s.memberProfiles)||null==(n=t[0])||null==(i=n.contributionCounts)?void 0:i.sumAllUgc)||0,error:r}})(n);return a?null:"min"===t?s>=e:s<=e},ce=()=>{var[{page:e,params:t}]=i(o),n=t.discountCode||null,a=!("Plus"!==e||!t.autopop&&""!==t.autopop||!n),s="Plus"===e&&null!==t.autopop&&t.autopop===Z;return a||s},de=()=>{var e=ce(),[{params:t}]=i(o);if(!e)return null;var n=t.discountCode||null;switch(n){case J:return ie;case W:return ae;case j:return se}if(null===n)switch(t.autopop||null){case Z:return le}return null},me="optimus_brand_interstitial",pe=({delaySeconds:e,afterPageViews:t,delayPageViews:a,maxSeen:l,maxSeenSession:c,isDatePickerOpen:m,onPopupDismiss:p,onOpen:v,onClose:C,fallback:_=null})=>{var{isOptimusEnabled:I,isOptimusSubscribed:b}=S(),[R,U]=n.useState(!0),[{page:x,params:O}]=n.useContext(o),D=O.discountCode||null,T=(()=>{var e,{userId:t}=i(u),n=de(),a=(()=>{var e=de(),t=r("optimus_discount_interstitial"),n=ce();return t&&n&&!e})(),s=r("optimus_discount_interstitial"),l=ue(2,"min"),c=(()=>{var e=ue(1,"max"),[{page:t,params:n}]=i(o),a=n.discountCode||null;return null===e?null:!("Plus"===t&&![null,J,W,j].includes(a))})(),d=(()=>{var[{page:e}]=i(o);return["OptimusHotelCheckout","OptimusSubscriptionCheckout"].includes(e)})();l?e=z:c&&(e=Y);var m=[];e&&m.push(e);var p=f({experimentKeys:m,userId:t||void 0,skipImpression:d||!s||null===l||null===c});if(!s||d)return"";if(null===p||null===a||null===l||null===c)return null;var v=e?p[e]:null;return e===z&&P.includes(v)&&!l||e===Y&&y.includes(v)&&!c?"":n||(a?te:e===Y&&v===ee?le:v||"")})(),V=ce(),{funnelKey:A}=i(d),F=g({members:k("/OptimusAccountManager"),nonMembers:k(`/OptimusSubscriptionCheckout?oik=${A}`)}),H=s((({variantName:e})=>{"endless"===e?F():U(!1)}),[F]),L=s((()=>{C&&C(),p&&p(),U(!1)}),[C,p]),G=()=>(p&&p(),_);if(null===T)return null;if("control"===T)return G();if(!I||b||!T&&!w&&!N)return G();var q=T;if(""===q){if(!w&&!N)return G();q=me}if(!q)return G();var $=(({variant:e,discountCode:t,onInterstitialClose:i,onInterstitialCta:a})=>E.includes(e)?(({variant:e,onInterstitialClose:t,onInterstitialCta:i})=>{var a;switch(e){case le:a="endless";break;case oe:default:a="swimming"}return n.createElement(M,{variant:a,onClose:()=>t(),onCtaClick:e=>i({variantName:e,isDiscount:!1}),dataAutomationTag:X})})({variant:e,onInterstitialClose:i,onInterstitialCta:a}):(({variant:e,discountCode:t,onInterstitialClose:i,onInterstitialCta:a})=>{var s,r=null==t?void 0:t.toUpperCase();switch(e){case te:s="community";break;case ne:s="savings";break;case ie:s="endless_a",r="SUMMER25";break;case ae:s="endless_b",r="SUMMER50";break;case se:s="endless_c",r="SUMMER75";break;default:throw new Error(`Discount interstitial not implemented for variant ${e}`)}return n.createElement(h,{code:r||"25OFF",onClose:()=>i(),onCtaClick:e=>a({variantName:e,isDiscount:!0}),variant:s,dataAutomationTag:X})})({variant:e,discountCode:t,onInterstitialClose:i,onInterstitialCta:a}))({variant:q,discountCode:D,onInterstitialClose:L,onInterstitialCta:H}),B=q===me&&(w&&!re.includes(x)||N);return n.createElement(Q,{delaySeconds:e,delayPageViews:V?0:a,afterPageViews:t,maxSeen:V?Number.MAX_SAFE_INTEGER:l,maxSeenSession:V?Number.MAX_SAFE_INTEGER:c,variantName:q,isDatePickerOpen:m,onSkip:p,suppress:B,ignoreInterval:V,onShow:v,fallback:_,isControl:N},R?$:_)},ve=e=>{var[t]=a(l());return n.createElement(c,{funnelKey:t},n.createElement(pe,e))};return[()=>{I=864e5,(b=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"UserGeneratedContent"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"userId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"UserIdInput"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"memberProfiles"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"userIds"},"value":{"kind":"ListValue","values":[{"kind":"Variable","name":{"kind":"Name","value":"userId"}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"contributionCounts"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"sumAllUgc"},"arguments":[],"directives":[]}]}}]}}]}}],"loc":{"start":0,"end":152}}')).__key=0x8aea4a23c3f4,h=C.component.onUsage((()=>t("_MrER3")),"default"),M=C.component.onUsage((()=>t("NkmoMN/Oi3Clo")),"BrandEducationInterstitial"),P=[ee,te,ne],y=[ee,ie,ae,se],E=[le,oe],w=r("optimus_edu_interstitial"),N=r("optimus_edu_interstitial_control"),ve.defaultProps={delaySeconds:30,afterPageViews:0,delayPageViews:1,maxSeen:3,maxSeenSession:1},e("default",ve)},[e=>(n=e.default,i=e.useContext,a=e.useState,s=e.useCallback),e=>r=e.featureIsEnabled,e=>l=e.uuid,e=>(o=e.Route,u=e.Visitor),e=>(c=e.FunnelTrackingProvider,d=e.FunnelTracking),e=>m=e.default,e=>p=e.default,e=>v=e.useImpressionLogger,e=>g=e.useOptimusLoginNavigation,e=>S=e.useOptimusEnabledForUser,e=>k=e.needsRouting,e=>f=e.default,e=>C=e,e=>_=e.useQuery]]},["cDcdfi","-i3PJS","O-HcBE","2R4xv2","ETqDaL","jaCyxS","qKFflQ","30t50h","mT-Pb2","v_y45t","oPZBqR","S-RL4Q","pLbCP4","5X2em-"]]);
