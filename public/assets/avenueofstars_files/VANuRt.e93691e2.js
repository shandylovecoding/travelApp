(this.$WP=this.$WP||[]).push(["VANuRt",(e,r)=>{"use strict";var o,a,n,t,l,i,s,u,d,c,g,h,p,w,S,m="https://smartlock.google.com",f=({options:e,onReady:r,onShowOverlay:a,onFlowStepChange:n})=>{var[t,i]=o.useState(),[s,u]=o.useState(),[d,c]=o.useState(!1),f="MOBILE"===o.useContext(l).viewportCategory,v=w(),{onSuccess:C,isFullWidthMobile:O}=e,y=o.useCallback((e=>{var r,o=e.resultData||"";if(o){var a=(e=>{var r={};try{r=JSON.parse(e)}catch(r){return console.error(`Error parsing controller result data: ${e}`),null}return"object"!=typeof r?(console.error("Parsed controller result is not an object."),null):{userId:r.user_id,hasCreatedMember:!!r.hasCreatedMember,hasAcceptedTermsOfUse:!!r.hasAcceptedTermsOfUse,loginProvider:r.loginProvider}})(o);null==a||a.hasCreatedMember,v((null==a?void 0:a.hasCreatedMember)?"CREATE":"LOGIN",null==a?void 0:a.userId,"SUCCESS"),C&&C(a)}else C&&C(null);e.jsCallback&&(r=e.jsCallback)&&console.error(`Non-empty JSCallback is returned from RegController: ${r}`)}),[C,v]),b=o.useCallback((e=>{e>100&&i(f&&O?"100%":e)}),[f,O]),{displayOnShowOverlay:I,onClose:k,onFailure:x}=e,E=o.useCallback((o=>{var t=o,l=(e=>{if(!e)return null;if(!e.origin||0!==e.origin.indexOf("https")||e.origin!==document.location.origin)return null;if(!e.data||!e.data.indexOf||-1===e.data.indexOf("action"))return null;try{var r=JSON.parse(e.data);return r.action?r:null}catch(e){return null}})(t);if((e=>{e&&e.origin&&0===e.origin.indexOf(m)&&e.data&&e.data.type&&e.source&&e.source.postMessage({type:"verifyAck",data:e.data.data},m)})(t),l){var{action:i}=l;switch(i){case"successClose":y(l);break;case"reloadWindow":console.error("Unexpected reload window message is received from RegController iframe");break;case"fwdToRelativeUrl":var s=l.url||"";s||console.error("No url specified to forward to."),0!==s.indexOf("/")&&console.error(`Cannot forward to absolute url: ${s}`),window.location=s;break;case"resizeFrame":b(l.width),l.height>100&&(e.ignoreScreenHeight?u(l.height):u(Math.min(l.height,window.innerHeight)));break;case"domReady":c(!0),r&&r();break;case"dismiss":k&&k();break;case"showOverlay":I&&a&&a();break;case"generalError":x&&x();break;case"splash":case"regSignIn":case"regSignUp":case"regForgotPassword":n&&n(i)}}}),[e.ignoreScreenHeight,y,I,a,n,k,r,b,x]);h("message",E);var M=o.useMemo((()=>{var r=e.extraQueryParams||{};Object.keys(r).forEach((e=>{void 0===r[e]&&delete r[e]}));var o=new URLSearchParams(Object.assign({flow:e.flow,flowOrigin:e.flowOrigin,pid:`${e.pid}`,hideNavigation:"true",userRequestedForce:"true",returnTo:"",isLithium:"true"},r));return e.mcid&&o.append("mcid",`${e.mcid}`),e.locationId&&o.append("locationId",`${e.locationId}`),e.stateToken&&o.append("stateToken",e.stateToken),void 0!==e.requireSecure&&o.append("requireSecure",`${String(!!e.requireSecure)}`),`/RegistrationController?${o.toString()}`}),[e.extraQueryParams,e.flow,e.flowOrigin,e.locationId,e.mcid,e.pid,e.requireSecure,e.stateToken]);return o.createElement("div",{className:g("_8RLaCUf_",{"_1ic0q52-":!f}),style:{width:t,height:s}},o.createElement(p,{className:"_30pzQStV",src:M,title:"regcontroller",style:{width:t,height:s,display:d?"block":"none"}}),o.createElement(S,null))},v=({options:e,closeX:r})=>{var a="MOBILE"===o.useContext(l).viewportCategory,[n,t]=o.useState(!1),i=o.useCallback((()=>{e.displayOnShowOverlay||t(!0)}),[e.displayOnShowOverlay]),s=o.useCallback((()=>{t(!0)}),[]),u=o.useMemo((()=>o.createElement(f,{options:e,onReady:i,onShowOverlay:s})),[i,e,s]);return o.createElement(d,{onClose:e.onClose,containerProps:{backgroundColor:"transparent",disableBodyScroll:!0},bodyProps:{isFullBleed:!0},enableCloseIcon:n&&r,roundedCorners:!a,hideBoxShadow:e.hideBoxShadow},o.createElement("div",{style:{display:n?"block":"none"}},u),!n&&o.createElement("div",{className:"nUBQ6pZw"},o.createElement(c,{size:"large",variant:"primary"})))},C=()=>{var{userId:e}=o.useContext(i),[r]=o.useContext(s),l=o.useContext(u),d=r.params.geoId||void 0,[c,g]=o.useState({flow:"CORE_COMBINED",flowOrigin:"join",pid:-1}),[h,p]=o.useState({closeX:!0}),w=t(),S=o.useRef(void 0),m=n((()=>o.createElement(v,{options:c,closeX:h.closeX})),{},[c,h]);return{login:o.useCallback((o=>e&&!o.forceLogin?Promise.resolve({userId:e,hasCreatedMember:null}):S.current?S.current:a()?("undefined"!=typeof window&&(window.location=`/RegistrationController?flow=${encodeURIComponent(o.flow||"CORE_COMBINED")}&pid=${encodeURIComponent(String(o.pid||-1))}&returnTo=${encodeURIComponent(r.path)}&fullscreen=true`),new Promise((()=>{}))):(S.current=new Promise((e=>{g({flow:o.flow||"CORE_COMBINED",flowOrigin:o.flowOrigin||"join",pid:o.pid||-1,isFullWidthMobile:o.isFullWidthMobile||!1,hideBoxShadow:o.hideBoxShadow||!1,extraQueryParams:o.extraQueryParams||{},displayOnShowOverlay:o.deferShowOverlay,requireSecure:o.requireSecure||!1,locationId:d||-1,onSuccess:r=>{var a={userId:(null==r?void 0:r.userId)||null,hasCreatedMember:!!(null==r?void 0:r.hasCreatedMember),loginProvider:null==r?void 0:r.loginProvider};o.onSuccess&&o.onSuccess(a),m.close(),S.current=null,l({userId:a.userId}),e(a)},onClose:()=>{w({module:"regoverlay",action:"closed",context:[d||"",o.flow].join("|"),value:o.pid||void 0,nonInteraction:!1}),m.close(),S.current=null,o.onClose&&o.onClose()},onFailure:()=>{o.onFailure&&o.onFailure()}}),p({closeX:!1!==o.closeX}),m.open()})),S.current)),[e,r.path,d,m,l,w]),close:m.close}},O=({flow:e,flowOrigin:r="login",pid:a=-1,isFullWidthMobile:n=!1,forceLogin:t=!1,extraQueryParams:l={},deferShowLogin:s=!0,requireSecure:d=!1,ignoreScreenHeight:c=!1,onLoginSuccess:g,onLoginFailure:h,onShowOverlay:p,onFlowStepChange:w})=>{var{userId:S}=o.useContext(i),m=o.useContext(u),v={flow:e,flowOrigin:r,pid:a,isFullWidthMobile:n,extraQueryParams:l,displayOnShowOverlay:s,requireSecure:d,ignoreScreenHeight:c,onSuccess:e=>{m({userId:(null==e?void 0:e.userId)||null}),g&&g()},onFailure:()=>{h&&h()}};return S&&!t?null:o.createElement(f,{options:v,onShowOverlay:p,onFlowStepChange:w})};return[()=>{e("default",C),e("AuthGate",O)},[e=>o=e,e=>a=e.default,e=>n=e.useVDOMPortal,e=>t=e.useGARecorder,e=>(l=e.Device,i=e.Visitor,s=e.Route,u=e.Authenticate),e=>d=e.default,e=>c=e.LoadingSpinner,e=>g=e.default,e=>h=e.useWindow,e=>p=e.EmbeddedContent,e=>(w=e.useUserAccountSiftTrackingAction,S=e.SiftTrackingIframe)]]},["cDcdfi","SfdMbo","vq6MSq","fsml46","2R4xv2","O8LbtK","V08PS7","jSLlaY","Dg5_-9","m5ZZFI","f9x1OV"]]);
