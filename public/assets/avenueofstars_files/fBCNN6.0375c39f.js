(this.$WP=this.$WP||[]).push(["fBCNN6",(e,r)=>{"use strict";var a,o,t,n,u,l,s=(e,r=[],o={loading:!1})=>{var t=a.useRef(e);a.useEffect((()=>{t.current=e}),[e]);var n=a.useRef(!1);a.useEffect((()=>(n.current=!0,()=>{n.current=!1})),[]);var[u,l]=a.useState(o);return[u,a.useCallback(((...e)=>{l({loading:!0}),t.current(...e).then((e=>(n.current&&l({value:e,loading:!1}),e)),(e=>(n.current&&l({error:e,loading:!1}),e)))}),r)]},c=(e,r,t)=>{var n,c,i,d,[v,f]=a.useState(null),[{value:m},p]=s(a.useCallback((e=>(e=>{if("mock"===e.forceMapProvider){var r={mapProvider:"mock",mapConfig:{lang:"en",channel:"ta.maps.mock"}};return new Promise((e=>e({json:()=>new Promise((e=>e(r)))})))}return fetch(`/data/1.0/maps/provider?${(e=>{var r={};return Object.keys(e).forEach((a=>{null!=e[a]&&(r[a]=e[a])})),new URLSearchParams(r)})({servletName:e.servletName,locale:e.locale,geoId:e.geoId,forceMapProvider:e.forceMapProvider}).toString()}`,{credentials:"same-origin"})})(e).then((e=>e.json()))),[])),[{value:g},P]=s(a.useCallback((e=>{var r=l[e];return r?r():Promise.reject(Error(`Unknown map provider ${e}`))}),[]),[]),[{loading:w,value:h},L]=(n=a.useRef(0),c=a.useRef(u()),i=a.useCallback(((e,r,a)=>{var o=new r;if(o.isLibraryLoaded())return new Promise((e=>e({loaded:!0,wasPreviouslyLoaded:!0})));var t=++n.current;return new Promise((r=>{o.loadLibrary(a,(()=>{if(c.current({module:"map_view",action:"load",context:e}),t!==n.current)throw new Error("Stale map provider request");r({loaded:!0,wasPreviouslyLoaded:!1})}))}))}),[]),(d=s(i))[0].loading?[d[0],()=>{}]:d),k=((e,r,t)=>{var n=a.useContext(o).locale.language;return a.useRef({servletName:t,locale:n,geoId:r,forceMapProvider:e}).current})(e,r,t),y=h&&h.loaded,E=m&&m.mapProvider,M=m&&m.mapConfig,b=g&&g.MapFactory;a.useLayoutEffect((()=>{p(k)}),[k,p]),a.useLayoutEffect((()=>{E&&P(E)}),[E,P]);var C=w||y;return a.useLayoutEffect((()=>{!C&&E&&M&&b&&L(E,b,Object.assign({lang:k.locale,channel:"ta.maps"},M))}),[C,k,b,M,E,L]),a.useLayoutEffect((()=>{y&&E&&g&&!v&&f({MapInterfaceClass:g.MapInterface,mapProviderName:E})}),[E,g,v,y]),v};return[()=>{l={[t]:()=>r("1lTcUI"),[n]:()=>r("q9bHm9"),mock:()=>r("RSaHg-")},e("useMapLoader",c)},[e=>a=e,e=>o=e.Environment,e=>(t=e.MapProviderGoogle,n=e.MapProviderAutonavi),e=>u=e.useGARecorder]]},["cDcdfi","2R4xv2","BGlljd","fsml46"]]);
